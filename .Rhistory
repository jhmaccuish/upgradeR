#Sys.sleep(2)
#readline(prompt="Press [enter] to continue")
q[currentAge-startAge+1,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
#print(cat("Sum CCPs", sum(q[currentAge-startAge+1,i-1,])))
q[currentAge-startAge+1,i-1,] <- q[currentAge-startAge+1,i-1,]/sum(q[currentAge-startAge+1,i-1,])
#print(cat("Sum Corrected CCPs", sum(q[currentAge-startAge+1,i-1,])))
print(q[currentAge-startAge+1,i-1,])
readline(prompt="Press [enter] to continue")
for (ageSPA in 60:67) {
if (nrow(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),])>1) {
hist(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$d12, xlim=c(1,numPercentiles+1) ,breaks = seq(1,numPercentiles+1,1),
main=paste("Age =",currentAge,"Income decile =", (i-1),"SPA Age =",ageSPA))
den = density(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$wlth1)
p[currentAge-startAge+1,ageSPA-59,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
else {p[currentAge-startAge+1,ageSPA-59,i-1,j-1] = 0}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
}
#readline(prompt="Press [enter] to continue")
}
}
}
p[1,1,,]
p[1,2,,]
p[1,3,,]
p[1,4,,]
p[1,5,,]
p[1,6,,]
p[1,7,,]
p[1,8,,]
p[1,9,,]
install.packages("sampleSelection")
install.packages("systemfit")
install.packages("sampleSelection")
###############################################
#       Main R Code for upgrade project
#   Author : Jamie Hentall MacCuish
###############################################
#cat("\014") # this clears the console window (clc in Matlab)
rm(list=ls()) # this clears the data space (clear all in Matlab)
#library(foreign)
library(np) # load the package "np"
library(plyr)
library(haven)
library(dplyr)
library(sfsmisc)
numPercentiles <- 4
PercentilePoints <- seq(0,1,length.out= numPercentiles+1)
startAge <- 57
endAge <- 57
q <- array(0,c((endAge-startAge+1),numPercentiles,numPercentiles))
p <- array(NA,c((endAge-startAge+1),8,numPercentiles,numPercentiles))
cleaned_data_waves1_8 <- read_dta("../Stata/data/cleaned_data_waves1-8.dta")
cleaned_data_waves1_8 <- cleaned_data_waves1_8[(cleaned_data_waves1_8$female == 1  ),]
for(currentAge in 57:57) {
newTest <- cleaned_data_waves1_8[,c('idauniq','age','bu_non_housing_wlth','wpactive','year_age_SPA')]
newTest <- newTest[(newTest$idauniq != 150791),]
newTest <- newTest[((newTest$age==currentAge | newTest$age==(currentAge+1)) &  !is.na(newTest$bu_non_housing_wlth)),]
newTest <- newTest[order(newTest$idauniq,newTest$age),]
leadData <- newTest %>% group_by(idauniq) %>% mutate( wlth1= lead(bu_non_housing_wlth, n = 1L, default = NA, order_by = age))
countdata <- plyr::count(newTest, vars = c("idauniq"))
deciles1 <- quantile(newTest[(newTest$age==currentAge),]$bu_non_housing_wlth, probs = PercentilePoints,na.rm=TRUE)
deciles2 <- quantile(newTest[(newTest$age==(currentAge+1)),]$bu_non_housing_wlth, probs = PercentilePoints,na.rm=TRUE)
countdata <- countdata[(countdata$freq==2),]
leadData <- leadData[(leadData$idauniq %in% countdata$idauniq),]
fiter <- function (wealth,age,percentile,selectAge) {
for (i in 1:length(percentile)){
if (wealth<percentile[i]){return(i)}
}
}
leadData <- mutate( leadData, d1=fiter(bu_non_housing_wlth,age,deciles1))
leadData <- mutate( leadData, d12=fiter(wlth1,age,deciles2))
leadData <- leadData[(leadData$age==currentAge),]
for (i in 2:(numPercentiles+1)) {
#print(cat("Current Conditioning Decile", i))
#print(nrow(leadData[(leadData$d1==i),]))
hist(leadData[(leadData$d1==i),]$d12, xlim=c(1,numPercentiles+1) ,breaks = seq(1,numPercentiles+1,1),
main=paste("Age =",currentAge,"Income decile =", (i-1),"Observations =",nrow(leadData[(leadData$d1==i),])))
#Sys.sleep(2)
den = density(leadData[(leadData$d1==i),]$wlth1)
#plot(den, main=paste("Age =",currentAge,"Income decile =", (i-1),"Observations =",nrow(leadData[(leadData$d1==i),])))
#abline(v=deciles2)
#Sys.sleep(2)
#readline(prompt="Press [enter] to continue")
q[currentAge-startAge+1,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
#print(cat("Sum CCPs", sum(q[currentAge-startAge+1,i-1,])))
q[currentAge-startAge+1,i-1,] <- q[currentAge-startAge+1,i-1,]/sum(q[currentAge-startAge+1,i-1,])
#print(cat("Sum Corrected CCPs", sum(q[currentAge-startAge+1,i-1,])))
print(q[currentAge-startAge+1,i-1,])
readline(prompt="Press [enter] to continue")
for (ageSPA in 60:67) {
if (nrow(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),])>1) {
hist(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$d12, xlim=c(1,numPercentiles+1) ,breaks = seq(1,numPercentiles+1,1),
main=paste("Age =",currentAge,"Income decile =", (i-1),"SPA Age =",ageSPA))
den = density(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$wlth1)
p[currentAge-startAge+1,ageSPA-59,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
else {p[currentAge-startAge+1,ageSPA-59,i-1,j-1] = 0}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
}
#readline(prompt="Press [enter] to continue")
}
}
}
## Wooldridge( 2003 ): example 17.5, page 590
data(Mroz87)
myProbit <- glm( lfp ~ nwifeinc + educ + exper + I( exper^2 ) + age +
kids5 + kids618, family = binomial( link = "probit" ), data=Mroz87 )
Mroz87$IMR <- invMillsRatio( myProbit )$IMR1
myHeckit <- lm( log( wage ) ~ educ + exper + I( exper^2 ) + IMR,
data = Mroz87[ Mroz87$lfp == 1, ] )
# using NO labor force participation as endogenous variable
Mroz87$nolfp <- 1 - Mroz87$lfp
###############################################
#       Main R Code for upgrade project
#   Author : Jamie Hentall MacCuish
###############################################
#cat("\014") # this clears the console window (clc in Matlab)
rm(list=ls()) # this clears the data space (clear all in Matlab)
#library(foreign)
library(np) # load the package "np"
library(plyr)
library(haven)
library(dplyr)
library(sfsmisc)
numPercentiles <- 4
PercentilePoints <- seq(0,1,length.out= numPercentiles+1)
startAge <- 57
endAge <- 57
q <- array(0,c((endAge-startAge+1),numPercentiles,numPercentiles))
p <- array(NA,c((endAge-startAge+1),8,numPercentiles,numPercentiles))
cleaned_data_waves1_8 <- read_dta("../Stata/data/cleaned_data_waves1-8.dta")
cleaned_data_waves1_8 <- cleaned_data_waves1_8[(cleaned_data_waves1_8$female == 1  ),]
for(currentAge in 57:57) {
newTest <- cleaned_data_waves1_8[,c('idauniq','age','bu_non_housing_wlth','wpactive','year_age_SPA')]
newTest <- newTest[(newTest$idauniq != 150791),]
newTest <- newTest[((newTest$age==currentAge | newTest$age==(currentAge+1)) &  !is.na(newTest$bu_non_housing_wlth)),]
newTest <- newTest[order(newTest$idauniq,newTest$age),]
leadData <- newTest %>% group_by(idauniq) %>% mutate( wlth1= lead(bu_non_housing_wlth, n = 1L, default = NA, order_by = age))
countdata <- plyr::count(newTest, vars = c("idauniq"))
deciles1 <- quantile(newTest[(newTest$age==currentAge),]$bu_non_housing_wlth, probs = PercentilePoints,na.rm=TRUE)
deciles2 <- quantile(newTest[(newTest$age==(currentAge+1)),]$bu_non_housing_wlth, probs = PercentilePoints,na.rm=TRUE)
countdata <- countdata[(countdata$freq==2),]
leadData <- leadData[(leadData$idauniq %in% countdata$idauniq),]
fiter <- function (wealth,age,percentile,selectAge) {
for (i in 1:length(percentile)){
if (wealth<percentile[i]){return(i)}
}
}
leadData <- mutate( leadData, d1=fiter(bu_non_housing_wlth,age,deciles1))
leadData <- mutate( leadData, d12=fiter(wlth1,age,deciles2))
leadData <- leadData[(leadData$age==currentAge),]
for (i in 2:(numPercentiles+1)) {
#print(cat("Current Conditioning Decile", i))
#print(nrow(leadData[(leadData$d1==i),]))
hist(leadData[(leadData$d1==i),]$d12, xlim=c(1,numPercentiles+1) ,breaks = seq(1,numPercentiles+1,1),
main=paste("Age =",currentAge,"Income decile =", (i-1),"Observations =",nrow(leadData[(leadData$d1==i),])))
#Sys.sleep(2)
den = density(leadData[(leadData$d1==i),]$wlth1)
#plot(den, main=paste("Age =",currentAge,"Income decile =", (i-1),"Observations =",nrow(leadData[(leadData$d1==i),])))
#abline(v=deciles2)
#Sys.sleep(2)
#readline(prompt="Press [enter] to continue")
q[currentAge-startAge+1,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
#print(cat("Sum CCPs", sum(q[currentAge-startAge+1,i-1,])))
q[currentAge-startAge+1,i-1,] <- q[currentAge-startAge+1,i-1,]/sum(q[currentAge-startAge+1,i-1,])
#print(cat("Sum Corrected CCPs", sum(q[currentAge-startAge+1,i-1,])))
print(q[currentAge-startAge+1,i-1,])
readline(prompt="Press [enter] to continue")
for (ageSPA in 60:67) {
if (nrow(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),])>1) {
hist(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$d12, xlim=c(1,numPercentiles+1) ,breaks = seq(1,numPercentiles+1,1),
main=paste("Age =",currentAge,"Income decile =", (i-1),"SPA Age =",ageSPA))
den = density(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$wlth1)
p[currentAge-startAge+1,ageSPA-59,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
else {p[currentAge-startAge+1,ageSPA-59,i-1,j-1] = 0}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
}
#readline(prompt="Press [enter] to continue")
}
}
}
# Greene( 2003 ): example 22.8, page 786
data( Mroz87 )
install.packages("sampleSelection")
# Greene( 2003 ): example 22.8, page 786
data( Mroz87 )
data( Mroz87 )
mroz87 =  read.table( "http://www.
montana.edu/ebelasco/ecns562/homew
ork/mroz87.dat", header = T)
mroz87 =  read.table( "http://www.montana.edu/ebelasco/ecns562/homework/mroz87.dat", header = T)
# Greene( 2003 ): example 22.8, page 786
rm(list=ls()) # this clears the data space (clear all in Matlab)
mroz87 =  read.table( "http://www.montana.edu/ebelasco/ecns562/homework/mroz87.dat", header = T)
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
# Two-step estimation
summary( heckit( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ) )
# ML estimation
summary( selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ))
# Greene( 2003 ): example 22.8, page 786
library(sampleSelection)
data( Mroz87 )
rm(list=ls()) # this clears the data space (clear all in Matlab)
#mroz87 =  read.table( "http://www.montana.edu/ebelasco/ecns562/homework/mroz87.dat", header = T)
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
# Two-step estimation
summary( heckit( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ) )
# ML estimation
summary( selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ))
data( Mroz87 )
# Greene( 2003 ): example 22.8, page 786
rm(list=ls()) # this clears the data space (clear all in Matlab)
library(sampleSelection)
data( Mroz87 )
#mroz87 =  read.table( "http://www.montana.edu/ebelasco/ecns562/homework/mroz87.dat", header = T)
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
# Two-step estimation
summary( heckit( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ) )
# ML estimation
summary( selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ))
###############################################
#       Main R Code for upgrade project
#   Author : Jamie Hentall MacCuish
###############################################
#cat("\014") # this clears the console window (clc in Matlab)
rm(list=ls()) # this clears the data space (clear all in Matlab)
#library(foreign)
library(np) # load the package "np"
library(plyr)
library(haven)
library(dplyr)
library(sfsmisc)
numPercentiles <- 4
PercentilePoints <- seq(0,1,length.out= numPercentiles+1)
startAge <- 57
endAge <- 57
q <- array(0,c((endAge-startAge+1),numPercentiles,numPercentiles))
p <- array(NA,c((endAge-startAge+1),8,numPercentiles,numPercentiles))
cleaned_data_waves1_8 <- read_dta("../Stata/data/cleaned_data_waves1-8.dta")
cleaned_data_waves1_8 <- cleaned_data_waves1_8[(cleaned_data_waves1_8$female == 1  ),]
for(currentAge in 57:57) {
newTest <- cleaned_data_waves1_8[,c('idauniq','age','bu_non_housing_wlth','wpactive','year_age_SPA')]
newTest <- newTest[(newTest$idauniq != 150791),]
newTest <- newTest[((newTest$age==currentAge | newTest$age==(currentAge+1)) &  !is.na(newTest$bu_non_housing_wlth)),]
newTest <- newTest[order(newTest$idauniq,newTest$age),]
leadData <- newTest %>% group_by(idauniq) %>% mutate( wlth1= lead(bu_non_housing_wlth, n = 1L, default = NA, order_by = age))
countdata <- plyr::count(newTest, vars = c("idauniq"))
deciles1 <- quantile(newTest[(newTest$age==currentAge),]$bu_non_housing_wlth, probs = PercentilePoints,na.rm=TRUE)
deciles2 <- quantile(newTest[(newTest$age==(currentAge+1)),]$bu_non_housing_wlth, probs = PercentilePoints,na.rm=TRUE)
countdata <- countdata[(countdata$freq==2),]
leadData <- leadData[(leadData$idauniq %in% countdata$idauniq),]
fiter <- function (wealth,age,percentile,selectAge) {
for (i in 1:length(percentile)){
if (wealth<percentile[i]){return(i)}
}
}
leadData <- mutate( leadData, d1=fiter(bu_non_housing_wlth,age,deciles1))
leadData <- mutate( leadData, d12=fiter(wlth1,age,deciles2))
leadData <- leadData[(leadData$age==currentAge),]
for (i in 2:(numPercentiles+1)) {
#print(cat("Current Conditioning Decile", i))
#print(nrow(leadData[(leadData$d1==i),]))
hist(leadData[(leadData$d1==i),]$d12, xlim=c(1,numPercentiles+1) ,breaks = seq(1,numPercentiles+1,1),
main=paste("Age =",currentAge,"Income decile =", (i-1),"Observations =",nrow(leadData[(leadData$d1==i),])))
#Sys.sleep(2)
den = density(leadData[(leadData$d1==i),]$wlth1)
#plot(den, main=paste("Age =",currentAge,"Income decile =", (i-1),"Observations =",nrow(leadData[(leadData$d1==i),])))
#abline(v=deciles2)
#Sys.sleep(2)
#readline(prompt="Press [enter] to continue")
q[currentAge-startAge+1,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
q[currentAge-startAge+1,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
#print(cat("Sum CCPs", sum(q[currentAge-startAge+1,i-1,])))
q[currentAge-startAge+1,i-1,] <- q[currentAge-startAge+1,i-1,]/sum(q[currentAge-startAge+1,i-1,])
#print(cat("Sum Corrected CCPs", sum(q[currentAge-startAge+1,i-1,])))
print(q[currentAge-startAge+1,i-1,])
readline(prompt="Press [enter] to continue")
for (ageSPA in 60:67) {
if (nrow(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),])>1) {
hist(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$d12, xlim=c(1,numPercentiles+1) ,breaks = seq(1,numPercentiles+1,1),
main=paste("Age =",currentAge,"Income decile =", (i-1),"SPA Age =",ageSPA))
den = density(leadData[(leadData$d1==i & leadData$year_age_SPA==ageSPA),]$wlth1)
p[currentAge-startAge+1,ageSPA-59,i-1,1] <- integrate.xy(den$x[(den$x<=deciles2[2])],den$y[(den$x<=deciles2[2])])
for (j in 3:(numPercentiles+1)){
if (length(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j-1]<den$x & den$x<=deciles2[j])],den$y[(deciles2[j-1]<den$x & den$x<=deciles2[j])])
}
else {p[currentAge-startAge+1,ageSPA-59,i-1,j-1] = 0}
}
if (length(den$x[(deciles2[j]<den$x)])>0){
p[currentAge-startAge+1,ageSPA-59,i-1,j-1] <- integrate.xy(den$x[(deciles2[j]<den$x)],den$y[(deciles2[j]<den$x)])
}
}
#readline(prompt="Press [enter] to continue")
}
}
}
View(cleaned_data_waves1_8)
View(cleaned_data_waves1_8)
rm(list=ls()) # this clears the data space (clear all in Matlab)
#library(foreign)
library(np) # load the package "np"
library(plyr)
library(haven)
library(dplyr)
library(sfsmisc)
numPercentiles <- 4
PercentilePoints <- seq(0,1,length.out= numPercentiles+1)
startAge <- 57
endAge <- 57
q <- array(0,c((endAge-startAge+1),numPercentiles,numPercentiles))
p <- array(NA,c((endAge-startAge+1),8,numPercentiles,numPercentiles))
cleaned_data_waves1_8 <- read_dta("../Stata/data/cleaned_data_waves1-8.dta")
View(cleaned_data_waves1_8)
# Greene( 2003 ): example 22.8, page 786
rm(list=ls()) # this clears the data space (clear all in Matlab)
library(sampleSelection)
data( Mroz87 )
#mroz87 =  read.table( "http://www.montana.edu/ebelasco/ecns562/homework/mroz87.dat", header = T)
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
# Two-step estimation
summary( heckit( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ) )
View(Mroz87)
View(Mroz87)
selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 )
selec <- selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 )
selec
# ML estimation
summary( selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ))
# Greene( 2003 ): example 22.8, page 786
rm(list=ls()) # this clears the data space (clear all in Matlab)
library(sampleSelection)
## Greene( 2003 ): example 22.8, page 786
data( Mroz87 )
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
# ML estimatio
m <- selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 )
predict( m )
rm(list=ls()) # this clears the data space (clear all in Matlab)
library(sampleSelection)
## Greene( 2003 ): example 22.8, page 786
data( Mroz87 )
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
# ML estimatio
m <- selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 )
Mroz87$fitted <- predict( m )
###############################################
#       Main R Code for upgrade project
#   Author : Jamie Hentall MacCuish
###############################################
#cat("\014") # this clears the console window (clc in Matlab)
rm(list=ls()) # this clears the data space (clear all in Matlab)
#library(foreign)
library(np) # load the package "np"
library(plyr)
library(haven)
library(dplyr)
library(sfsmisc)
library(sampleSelection)
numPercentiles <- 4
PercentilePoints <- seq(0,1,length.out= numPercentiles+1)
startAge <- 57
endAge <- 57
q <- array(0,c((endAge-startAge+1),numPercentiles,numPercentiles))
p <- array(NA,c((endAge-startAge+1),8,numPercentiles,numPercentiles))
cleaned_data_waves1_8 <- read_dta("../Stata/data/cleaned_data_waves1-8.dta")
View(cleaned_data_waves1_8)
View(cleaned_data_waves1_8)
cleaned_data_waves1_8[1]$under_SPA
cleaned_data_waves1_8$over_SPA
cleaned_data_waves1_8$edu_yr
###############################################
#       Main R Code for upgrade project
#   Author : Jamie Hentall MacCuish
###############################################
#cat("\014") # this clears the console window (clc in Matlab)
rm(list=ls()) # this clears the data space (clear all in Matlab)
#library(foreign)
library(np) # load the package "np"
library(plyr)
library(haven)
library(dplyr)
library(sfsmisc)
library(sampleSelection)
numPercentiles <- 4
PercentilePoints <- seq(0,1,length.out= numPercentiles+1)
startAge <- 57
endAge <- 57
q <- array(0,c((endAge-startAge+1),numPercentiles,numPercentiles))
p <- array(NA,c((endAge-startAge+1),8,numPercentiles,numPercentiles))
cleaned_data_waves1_8 <- read_dta("../Stata/data/cleaned_data_waves1-8.dta")
cleaned_data_waves1_8 <- cleaned_data_waves1_8[(cleaned_data_waves1_8$female == 1  ),]
heck <- selection( wpactive  ~ age + I( age^2 ) + over_SPA + marstat + edu_y,
individual_net_emp_inc ~ age + I( age^2 ) + +tenure + edu_y + gor, cleaned_data_waves1_8 )
cleaned_data_waves1_8$y_fitted <- predict( m )
###############################################
#       Main R Code for upgrade project
#   Author : Jamie Hentall MacCuish
###############################################
#cat("\014") # this clears the console window (clc in Matlab)
rm(list=ls()) # this clears the data space (clear all in Matlab)
#library(foreign)
library(np) # load the package "np"
library(plyr)
library(haven)
library(dplyr)
library(sfsmisc)
library(sampleSelection)
numPercentiles <- 4
PercentilePoints <- seq(0,1,length.out= numPercentiles+1)
startAge <- 57
endAge <- 57
q <- array(0,c((endAge-startAge+1),numPercentiles,numPercentiles))
p <- array(NA,c((endAge-startAge+1),8,numPercentiles,numPercentiles))
cleaned_data_waves1_8 <- read_dta("../Stata/data/cleaned_data_waves1-8.dta")
cleaned_data_waves1_8 <- cleaned_data_waves1_8[(cleaned_data_waves1_8$female == 1  ),]
heck <- selection( wpactive  ~ age + I( age^2 ) + over_SPA + marstat + edu_yr,
individual_net_emp_inc ~ age + I( age^2 ) + +tenure + edu_yr + gor, cleaned_data_waves1_8 )
cleaned_data_waves1_8$y_fitted <- predict( m )
summary(heck)
heck <- selection( wpactive  ~ age + + over_SPA + marstat + edu_yr,
individual_net_emp_inc ~ age + + +tenure + edu_yr + gor, cleaned_data_waves1_8 )
summary(heck)
data( Mroz87 )
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
# ML estimatio
m <- selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
wage ~ exper + I( exper^2 ) + educ + city, Mroz87 )
summary(m)
summary(heck)
heck <- selection( wpactive  ~ age + over_SPA + marstat,
individual_net_emp_inc ~ age +tenure + edu_yr + gor, cleaned_data_waves1_8 )
summary(heck)
temp <- cleaned_data_waves1_8[,c('idauniq','age','bu_non_housing_wlth','wpactive','year_age_SPA' 'age' 'over_SP' 'marstat' 'individual_net_emp_inc' 'tenure' 'edu_yr' 'gor')]
temp <- cleaned_data_waves1_8[,c('idauniq','age','bu_non_housing_wlth','wpactive','year_age_SPA','age','over_SP','marstat','individual_net_emp_inc','tenure','edu_yr','gor')]
temp <- cleaned_data_waves1_8[,c('idauniq','age','bu_non_housing_wlth','wpactive','year_age_SPA','age','over_SPA','marstat','individual_net_emp_inc','tenure','edu_yr','gor')]
View(temp)
View(temp)
View(Mroz87)
View(Mroz87)
summary(heck)
heck <- selection( wpactive  ~ age + over_SPA + marstat,
individual_net_emp_inc ~ age +tenure + edu_yr, cleaned_data_waves1_8 )
summary(heck)
heck <- selection( wpactive  ~ age + over_SPA + marstat,
individual_net_emp_inc ~ age +tenure + edu_yr + gor, cleaned_data_waves1_8 )
cleaned_data_waves1_8$y_fitted <- predict( heck )
help(density)
help(kde2d)
